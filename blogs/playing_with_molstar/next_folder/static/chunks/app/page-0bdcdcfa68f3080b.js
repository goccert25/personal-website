(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{30331:function(e,t,r){Promise.resolve().then(r.bind(r,33343))},33343:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var a=r(60230),s=r(57437),n=r(2265),l=r(76324),i=r.n(l),o=r(74275),c=r.n(o),u=r(20987),d=r(52282),p=r(71574),f=r(6486);r(50271);var m=r(21218),h=r(30150);let y=e=>{let{useInterface:t,pdbId:r,url:a,file:l,dimensions:i,className:o,showControls:c,showAxes:y,onLoad:x}=e,b=(0,n.useRef)(null),v=(0,n.useRef)(null),g=(0,n.useRef)(null),[w,_]=(0,n.useState)(!1);(0,n.useEffect)(()=>((async()=>{if(t){let e=(0,d.q)();e.layout={initial:{isExpanded:!1,controlsDisplay:"reactive",showControls:c}},g.current=await (0,p.a)(b.current,e)}else{let e=(0,u.u)();e.canvas3d={renderer:{backgroundColor:0}},g.current=new f.Z(e),g.current.initViewer(v.current,b.current),await g.current.init()}if(!y){var e;null===(e=g.current.canvas3d)||void 0===e||e.setProps({camera:{helper:{axes:{name:"off",params:{}}}}})}await j(r,a,l,g.current),_(!0)})(),()=>g.current=null),[]),(0,n.useEffect)(()=>{w&&(async()=>{await j(r,a,l,g.current)})()},[r,a,l]),(0,n.useEffect)(()=>{if(g.current){var e,t;y?null===(t=g.current.canvas3d)||void 0===t||t.setProps({camera:{helper:{axes:m.e.getDefaultValues(h.n1).axes}}}):null===(e=g.current.canvas3d)||void 0===e||e.setProps({camera:{helper:{axes:{name:"off",params:{}}}}})}},[y]);let j=async(e,t,r,a)=>{if(""!==e&&a){if(a.clear(),r){let e=await a.builders.data.rawData({data:r.filestring}),t=await a.builders.structure.parseTrajectory(e,r.type);await a.builders.structure.hierarchy.applyPreset(t,"default")}else{let r=t||(e?"https://files.rcsb.org/view/".concat(e,".cif"):null);if(!r)return;let s=await a.builders.data.download({url:r},{state:{isGhost:!0}}),n=r.split(".").pop().replace("cif","mmcif");n.includes("?")&&(n=n.substring(0,n.indexOf("?")));try{let e=await a.builders.structure.parseTrajectory(s,n);await a.builders.structure.hierarchy.applyPreset(e,"default"),x()}catch(e){console.log("render error caught")}}}},N=i?i[0]:"100%",P=i?i[1]:"100%";return t?(0,s.jsx)("div",{style:{position:"absolute",width:N,height:P,overflow:"hidden"},children:(0,s.jsx)("div",{ref:b,style:{position:"absolute",left:0,top:0,right:0,bottom:0}})}):(0,s.jsx)("div",{ref:b,style:{position:"relative",width:N,height:P},className:o||"",children:(0,s.jsx)("canvas",{ref:v,style:{position:"absolute",top:0,left:0,right:0,bottom:0}})})};y.propTypes={useInterface:c().bool,pdbId:c().string,url:c().string,file:c().object,dimensions:c().array,showControls:c().bool,showAxes:c().bool,className:c().string,onLoad:c().func};var x=r(5779),b=r(14798),v=r(67389),g=r(75671);function w(){let e=(0,a._)(["\n  query Entries ($ids: [String!]!) {\n    entries(entry_ids:$ids){\n      struct {\n          title\n      }\n    }\n  }\n"]);return w=function(){return e},e}let _=(0,v.Ps)(w()),j={control:e=>({...e,backgroundColor:"white"}),option:(e,t)=>{let{data:r,isDisabled:a,isFocused:s,isSelected:n}=t,l=i()("black");return{...e,backgroundColor:s?l.alpha(.1).css():"white",color:n?"black":l.alpha(.5).css()}}};function N(e){let{children:t,...r}=e,{selectProps:a}=e;return a.menuIsOpen?(0,s.jsx)(n.Fragment,{}):(0,s.jsx)(x.c.SingleValue,{...r,children:t})}function P(){let[e,t]=(0,n.useState)(""),[r,a]=(0,n.useState)("N/A"),[l,i]=(0,n.useState)(!1),o=(0,n.useRef)(),[c,{loading:u,error:d}]=(0,g.t)(_);return(0,s.jsx)("main",{children:(0,s.jsx)("div",{className:"h-screen flex justify-center",children:(0,s.jsxs)("div",{className:"w-full h-full max-h-[800px] max-w-[800px]",children:[(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsx)("h1",{className:"text-3xl m-md",children:"Simple Protein Viewer"})}),"Protein Search:",(0,s.jsx)(b.Z,{components:{SingleValue:N},styles:j,loadOptions:(e,t)=>{if(""===e)return;let r=encodeURIComponent(JSON.stringify({query:{type:"group",nodes:[{type:"group",nodes:[{type:"terminal",service:"text",parameters:{attribute:"rcsb_entry_info.structure_determination_methodology",operator:"exact_match",value:"experimental"}},{type:"terminal",service:"text",parameters:{attribute:"entity_poly.rcsb_entity_polymer_type",value:"Protein",operator:"exact_match"}}],logical_operator:"and",label:"text"},{type:"terminal",service:"full_text",parameters:{value:e}}],logical_operator:"and"},return_type:"entry",request_options:{paginate:{start:0,rows:25},results_content_type:["experimental"],sort:[{sort_by:"score",direction:"desc"}],scoring_strategy:"combined"}})),a="https://search.rcsb.org/rcsbsearch/v2/query?json=".concat(r),s=(e,t)=>r=>{let a=[];for(let t=0;t<e.length;t+=1)a.push({value:e[t],label:r.entries[t].struct.title});t(a)},n=async()=>{try{let r=await fetch(a),n=await r.json(),l=[],i=[];for(var e of n.result_set)l.push({value:e.identifier,label:e.identifier}),i.push(e.identifier);c({variables:{ids:i},onCompleted:s(i,t)})}catch(e){console.error("Error fetching data:",e)}};clearTimeout(o.current),o.current=setTimeout(()=>{n()},500)},onChange:function(r){r.value!=e&&(a(r.label),t(r.value),i(!0))},placeholder:"Search",loadingMessage:()=>"Loading, may take a few seconds..."}),(0,s.jsx)("div",{className:"text-lg mt-md",children:"Description:"}),(0,s.jsx)("div",{className:"text-lg mb-sm",children:r}),l&&(0,s.jsx)("div",{className:"text-lg mb-sm",children:"Rendering structure..."}),(0,s.jsx)(y,{useInterface:!1,pdbId:e,onLoad:()=>{i(!1)}}),(0,s.jsx)("div",{className:"text-sm",children:"Protein visualization library from https://molstar.org/"})]})})})}}},function(e){e.O(0,[760,354,81,291,971,938,744],function(){return e(e.s=30331)}),_N_E=e.O()}]);